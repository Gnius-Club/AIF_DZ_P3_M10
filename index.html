<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Misi√≥n 10: Chefs de la IA - Edici√≥n Experta</title>
  <style>
    :root {
      /* Paleta de Alto Contraste para Ni√±os */
      --bg-deep: #020617;      /* Negro azulado profundo */
      --panel-bg: #1e293b;     /* Gris pizarra */
      --text-main: #ffffff;    /* Blanco puro */
      --text-muted: #cbd5e1;   /* Gris claro */
      
      --accent-genia: #a855f7; /* Violeta vibrante (IA) */
      --accent-action: #0ea5e9;/* Azul Cyan (Botones) */
      --success: #22c55e;      /* Verde √©xito */
      --warning: #facc15;      /* Amarillo alerta */
      --danger: #ef4444;       /* Rojo error */
      
      --font-body: 'Verdana', sans-serif; /* Tipograf√≠a muy legible */
    }

    * { box-sizing: border-box; user-select: none; }

    body {
      margin: 0;
      background-color: var(--bg-deep);
      color: var(--text-main);
      font-family: var(--font-body);
      height: 100vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    /* --- UI GENERICA --- */
    button { cursor: pointer; border: none; font-family: inherit; transition: transform 0.1s, filter 0.2s; }
    button:active { transform: scale(0.96); }
    
    .hidden { display: none !important; }
    .fade-in { animation: fadeIn 0.5s ease-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    /* Barra Superior */
    header {
      background: rgba(30, 41, 59, 0.9);
      border-bottom: 2px solid var(--accent-genia);
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 20px rgba(0,0,0,0.5);
      z-index: 100;
    }
    .brand { display: flex; align-items: center; gap: 12px; }
    .logo-glow { 
      font-size: 28px; background: var(--accent-genia); 
      width: 48px; height: 48px; border-radius: 12px; 
      display: grid; place-items: center; 
      box-shadow: 0 0 15px var(--accent-genia);
    }
    .game-title h1 { margin: 0; font-size: 20px; color: var(--warning); text-transform: uppercase; letter-spacing: 1px; }
    .game-title span { font-size: 12px; color: var(--text-muted); }

    .controls { display: flex; gap: 10px; }
    .icon-btn { 
      background: #334155; color: white; padding: 8px 16px; 
      border-radius: 20px; font-weight: bold; border: 1px solid #475569;
    }
    .icon-btn.active { background: var(--success); border-color: var(--success); color: #000; }

    /* Contenedor Central */
    main {
      flex: 1;
      position: relative;
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      overflow-y: auto;
    }

    /* PANTALLAS */
    .screen {
      display: none;
      height: 100%;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .screen.active { display: flex; }

    /* --- PANTALLA INICIO --- */
    .hero-card {
      background: var(--panel-bg);
      border: 3px solid var(--accent-action);
      padding: 40px;
      border-radius: 24px;
      text-align: center;
      max-width: 700px;
      box-shadow: 0 20px 50px rgba(0,0,0,0.6);
    }
    .big-title { font-size: 42px; margin: 0 0 20px 0; color: var(--text-main); text-shadow: 0 4px 0 #000; }
    .big-title span { color: var(--accent-genia); }
    .start-btn {
      background: linear-gradient(to bottom, #38bdf8, #0284c7);
      font-size: 28px; padding: 20px 60px; border-radius: 50px;
      color: white; font-weight: 900; box-shadow: 0 8px 0 #0369a1, 0 15px 20px rgba(0,0,0,0.4);
      margin-top: 30px; transition: transform 0.1s;
    }
    .start-btn:active { transform: translateY(8px); box-shadow: 0 0 0 #0369a1; }

    /* --- TUTORIAL (Dise√±o Narrativo) --- */
    .tutorial-layout {
      display: grid;
      grid-template-columns: 300px 1fr;
      gap: 30px;
      background: var(--panel-bg);
      padding: 30px;
      border-radius: 24px;
      border: 2px solid #475569;
      max-width: 1000px;
      width: 100%;
    }
    .producer-avatar {
      background: #0f172a;
      border-radius: 20px;
      padding: 20px;
      text-align: center;
      border: 2px solid var(--warning);
    }
    .avatar-img { font-size: 100px; display: block; margin-bottom: 10px; filter: drop-shadow(0 4px 10px rgba(0,0,0,0.5)); }
    .speech-bubble {
      background: #fff;
      color: #000;
      padding: 25px;
      border-radius: 20px;
      font-size: 20px;
      line-height: 1.5;
      position: relative;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }
    .speech-bubble::after { /* Pico del globo */
      content: ''; position: absolute; left: -20px; top: 40px;
      border: 10px solid transparent; border-right-color: #fff;
    }
    
    .interactive-area {
      margin-top: 20px;
      background: rgba(0,0,0,0.3);
      padding: 20px;
      border-radius: 15px;
      display: flex;
      align-items: center;
      justify-content: space-around;
      border: 2px dashed #64748b;
    }
    
    /* Animaci√≥n de "Click aqu√≠" */
    .pointer-hand {
      font-size: 40px;
      position: absolute;
      animation: point 1s infinite alternate;
      z-index: 10;
      filter: drop-shadow(0 4px 4px rgba(0,0,0,0.5));
      pointer-events: none;
    }
    @keyframes point { from { transform: translateY(0); } to { transform: translateY(-15px); } }

    .tut-folder-btn {
      background: var(--warning); color: #000;
      width: 120px; height: 100px; border-radius: 12px;
      font-weight: bold; font-size: 16px;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      box-shadow: 0 6px 0 #b45309;
      position: relative;
    }
    .tut-folder-btn:active { transform: translateY(6px); box-shadow: none; }

    /* --- MESA DE JUEGO (GAMEPLAY) --- */
    .game-grid {
      display: grid;
      grid-template-columns: 1fr 320px;
      gap: 20px;
      width: 100%;
      height: 100%;
    }

    .main-panel {
      display: flex; flex-direction: column; gap: 15px;
      overflow-y: auto; padding-right: 10px;
    }

    /* Tarjetas de Decisi√≥n */
    .design-card {
      background: var(--panel-bg);
      border: 2px solid #334155;
      border-radius: 16px;
      padding: 20px;
      opacity: 0.5;
      pointer-events: none;
      transition: all 0.3s;
    }
    .design-card.active { opacity: 1; pointer-events: all; border-color: var(--accent-action); box-shadow: 0 0 20px rgba(14, 165, 233, 0.2); }
    .design-card.done { opacity: 0.8; border-color: var(--success); background: #064e3b; }

    .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
    .card-title { font-size: 20px; font-weight: bold; color: var(--accent-action); }
    .card-title.done-text { color: var(--success); }

    .options-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
    .option-btn {
      background: #0f172a; border: 2px solid #334155;
      padding: 15px; border-radius: 12px;
      display: flex; align-items: center; gap: 15px;
      text-align: left; transition: all 0.2s;
    }
    .option-btn:hover { background: #1e293b; border-color: #94a3b8; }
    .option-btn.selected-bad { border-color: var(--warning); background: #451a03; }
    .option-btn.selected-good { border-color: var(--success); background: #064e3b; }
    
    .opt-icon { font-size: 32px; background: rgba(255,255,255,0.1); width: 50px; height: 50px; display: grid; place-items: center; border-radius: 8px; }
    .opt-text h4 { margin: 0; font-size: 16px; color: #fff; }
    .opt-text p { margin: 5px 0 0; font-size: 12px; color: #94a3b8; }

    /* Barra Lateral (Testers y Consola) */
    .sidebar { display: flex; flex-direction: column; gap: 15px; }
    
    .console-box {
      background: #000; border: 1px solid #333;
      padding: 15px; border-radius: 12px;
      font-family: 'Courier New', monospace; font-size: 13px;
      color: var(--success); height: 100px; overflow: hidden;
    }
    .console-line { margin-bottom: 4px; border-bottom: 1px dashed #333; padding-bottom: 2px; }

    .testers-box {
      background: var(--panel-bg); padding: 15px; border-radius: 16px; border: 1px solid #334155;
      flex: 1; display: flex; flex-direction: column; gap: 10px;
    }
    .tester-item {
      background: rgba(255,255,255,0.05); padding: 10px; border-radius: 10px;
      display: flex; align-items: center; gap: 10px;
      transition: transform 0.2s;
    }
    .tester-item.bounce { animation: bounce 0.5s; }
    @keyframes bounce { 0%, 100% {transform: scale(1);} 50% {transform: scale(1.1);} }

    .launch-btn {
      width: 100%; background: #475569; color: #94a3b8;
      padding: 20px; font-size: 20px; font-weight: bold; border-radius: 12px;
      cursor: not-allowed;
    }
    .launch-btn.ready {
      background: linear-gradient(90deg, var(--success), #16a34a);
      color: white; cursor: pointer;
      animation: pulseGreen 2s infinite;
    }
    @keyframes pulseGreen { 0% {box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7);} 70% {box-shadow: 0 0 0 10px rgba(34, 197, 94, 0);} 100% {box-shadow: 0 0 0 0 rgba(34, 197, 94, 0);} }

    /* --- RESULTADOS --- */
    .result-container {
      background: var(--panel-bg); padding: 40px; border-radius: 30px;
      border: 4px solid var(--accent-genia); text-align: center; max-width: 600px;
    }
    .stars-display { font-size: 50px; color: var(--warning); letter-spacing: 5px; margin: 10px 0; }
    
    /* Mensajes Flotantes */
    .toast {
      position: fixed; top: 80px; left: 50%; transform: translateX(-50%);
      background: #fff; color: #000; padding: 15px 30px; border-radius: 50px;
      font-weight: bold; font-size: 18px; opacity: 0; pointer-events: none; transition: 0.3s;
      z-index: 200; box-shadow: 0 10px 20px rgba(0,0,0,0.5);
    }
    .toast.show { opacity: 1; top: 100px; }
    .toast.bad { background: var(--danger); color: white; border: 2px solid white; }
    .toast.good { background: var(--success); color: white; border: 2px solid white; }

  </style>
</head>
<body>

  <header>
    <div class="brand">
      <div class="logo-glow">üß†</div>
      <div class="game-title">
        <h1>Estudio de Juegos</h1>
        <span>Misi√≥n: Chefs de la IA</span>
      </div>
    </div>
    <div class="controls">
      <button class="icon-btn active" id="btn-voice" onclick="toggleVoice()">üó£Ô∏è Voz: ON</button>
    </div>
  </header>

  <main>
    <!-- 1. PANTALLA INICIO -->
    <div id="screen-start" class="screen active">
      <div class="hero-card fade-in">
        <h1 class="big-title">Dise√±ador <span>Inclusivo</span></h1>
        <p style="font-size: 20px; color: var(--text-muted); line-height: 1.6;">
          ¬°Bienvenido al Estudio! Tu misi√≥n es ense√±ar a la IA a crear videojuegos divertidos para <b>TODOS</b>.
        </p>
        <p style="color: var(--warning); margin-top: 10px;">‚ö†Ô∏è Reto: Evita el sesgo y gana 5 estrellas.</p>
        <button class="start-btn" onclick="startTutorial()">‚ñ∂ JUGAR AHORA</button>
      </div>
    </div>

    <!-- 2. PANTALLA TUTORIAL INTERACTIVO -->
    <div id="screen-tutorial" class="screen">
      <div class="tutorial-layout fade-in">
        <div class="producer-avatar">
          <span class="avatar-img">üë©‚Äçüíº</span>
          <h3 style="margin:0; color: var(--warning)">Productora</h3>
        </div>
        
        <div class="tutorial-content">
          <!-- El texto cambiar√° din√°micamente -->
          <div class="speech-bubble" id="tut-speech">
            Cargando...
          </div>

          <div class="interactive-area" id="tut-interaction">
            <!-- Elementos generados por JS -->
          </div>
          
          <button id="tut-next-btn" class="start-btn" style="font-size: 20px; padding: 15px 30px; display:none; float:right;" onclick="nextTutorialStep()">Continuar ‚û°</button>
        </div>
      </div>
    </div>

    <!-- 3. PANTALLA DE JUEGO -->
    <div id="screen-game" class="screen">
      <div class="game-grid fade-in">
        
        <!-- MESA DE DECISIONES -->
        <div class="main-panel">
          
          <!-- Tarjeta 1: Personajes -->
          <div id="card-1" class="design-card active">
            <div class="card-header">
              <span class="card-title">1. ¬øQu√© h√©roes tendr√° el juego?</span>
            </div>
            <div class="options-row">
              <button class="option-btn" onclick="selectCard(1, 'A')">
                <div class="opt-icon">üë∏</div>
                <div class="opt-text">
                  <h4>Carpeta A: "Realeza"</h4>
                  <p>Solo pr√≠ncipes y princesas rubios.</p>
                </div>
              </button>
              <button class="option-btn" onclick="selectCard(1, 'B')">
                <div class="opt-icon">üåç</div>
                <div class="opt-text">
                  <h4>Carpeta B: "Mundo Diverso"</h4>
                  <p>Robots, magos, h√©roes de todo el mundo.</p>
                </div>
              </button>
            </div>
          </div>

          <!-- Tarjeta 2: M√∫sica -->
          <div id="card-2" class="design-card">
            <div class="card-header">
              <span class="card-title">2. ¬øQu√© m√∫sica sonar√°?</span>
            </div>
            <div class="options-row">
              <button class="option-btn" onclick="selectCard(2, 'A')">
                <div class="opt-icon">üé∏</div>
                <div class="opt-text">
                  <h4>Carpeta A: "Solo Rock"</h4>
                  <p>Guitarra el√©ctrica muy fuerte.</p>
                </div>
              </button>
              <button class="option-btn" onclick="selectCard(2, 'B')">
                <div class="opt-icon">üé∂</div>
                <div class="opt-text">
                  <h4>Carpeta B: "Mix Musical"</h4>
                  <p>Rock, pop alegre y misterio.</p>
                </div>
              </button>
            </div>
          </div>

          <!-- Tarjeta 3: Niveles -->
          <div id="card-3" class="design-card">
            <div class="card-header">
              <span class="card-title">3. ¬øQu√© har√°n los jugadores?</span>
            </div>
            <div class="options-row">
              <button class="option-btn" onclick="selectCard(3, 'A')">
                <div class="opt-icon">‚öîÔ∏è</div>
                <div class="opt-text">
                  <h4>Carpeta A: "Pelea Total"</h4>
                  <p>Solo niveles de combate.</p>
                </div>
              </button>
              <button class="option-btn" onclick="selectCard(3, 'B')">
                <div class="opt-icon">üß©</div>
                <div class="opt-text">
                  <h4>Carpeta B: "Aventura Total"</h4>
                  <p>Combate, acertijos y exploraci√≥n.</p>
                </div>
              </button>
            </div>
          </div>

        </div>

        <!-- BARRA LATERAL -->
        <div class="sidebar">
          <div class="console-box" id="ai-console">
            <div class="console-line">>> Gen.IA lista.</div>
            <div class="console-line">>> Esperando datos...</div>
          </div>

          <div class="testers-box">
            <h4 style="margin:0; text-align:center; color: var(--accent-action)">REACCI√ìN EN VIVO</h4>
            <div class="tester-item" id="t-war">
              <span style="font-size:24px">üõ°Ô∏è</span>
              <div>
                <b>Guerrero</b>
                <div class="stars" id="s-war">‚≠ê‚≠ê‚≠ê</div>
              </div>
            </div>
            <div class="tester-item" id="t-mag">
              <span style="font-size:24px">ü™Ñ</span>
              <div>
                <b>Mago</b>
                <div class="stars" id="s-mag">‚≠ê‚≠ê‚≠ê</div>
              </div>
            </div>
            <div class="tester-item" id="t-exp">
              <span style="font-size:24px">üß≠</span>
              <div>
                <b>Explorador</b>
                <div class="stars" id="s-exp">‚≠ê‚≠ê‚≠ê</div>
              </div>
            </div>
          </div>

          <button id="btn-launch" class="launch-btn" onclick="finishGame()">üöÄ LANZAR JUEGO</button>
          <button onclick="restartGame()" style="background:transparent; color:#64748b; font-size:14px; margin-top:5px;">‚Ü∫ Reiniciar mesa</button>
        </div>

      </div>
    </div>

    <!-- 4. RESULTADO -->
    <div id="screen-result" class="screen">
      <div class="result-container fade-in">
        <div style="font-size:80px;" id="res-emoji">üèÜ</div>
        <h2 id="res-title" style="font-size:36px; color: #fff;">¬°T√≠tulo!</h2>
        <div class="stars-display" id="res-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
        <p id="res-text" style="font-size:20px; line-height:1.5;">Texto</p>
        <button class="start-btn" onclick="restartGame()">Jugar Otra Vez</button>
      </div>
    </div>

    <!-- TOAST -->
    <div id="toast" class="toast">Mensaje</div>

  </main>

  <script>
    /* --- AUDIO SYSTEM (No intrusivo) --- */
    const ctx = new (window.AudioContext || window.webkitAudioContext)();
    let voiceOn = true;

    function playSound(type) {
      if(ctx.state === 'suspended') ctx.resume();
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.connect(gain);
      gain.connect(ctx.destination);

      const now = ctx.currentTime;
      if (type === 'click') {
        osc.frequency.setValueAtTime(400, now);
        osc.type = 'sine';
        gain.gain.setValueAtTime(0.1, now);
        gain.gain.exponentialRampToValueAtTime(0.001, now + 0.1);
        osc.start(now); osc.stop(now + 0.1);
      } else if (type === 'good') {
        osc.type = 'triangle';
        osc.frequency.setValueAtTime(600, now);
        osc.frequency.exponentialRampToValueAtTime(1200, now + 0.2);
        gain.gain.setValueAtTime(0.1, now);
        gain.gain.exponentialRampToValueAtTime(0.001, now + 0.4);
        osc.start(now); osc.stop(now + 0.4);
      } else if (type === 'bad') {
        osc.type = 'sawtooth';
        osc.frequency.setValueAtTime(150, now);
        osc.frequency.linearRampToValueAtTime(100, now + 0.3);
        gain.gain.setValueAtTime(0.1, now);
        gain.gain.linearRampToValueAtTime(0.001, now + 0.3);
        osc.start(now); osc.stop(now + 0.3);
      } else if (type === 'win') {
        // Fanfare
        [523, 659, 784, 1046].forEach((f, i) => {
           setTimeout(() => {
             const o = ctx.createOscillator(); const g = ctx.createGain();
             o.connect(g); g.connect(ctx.destination);
             o.type='square'; o.frequency.value=f;
             g.gain.value=0.1; g.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime+0.5);
             o.start(); o.stop(ctx.currentTime+0.5);
           }, i*150);
        });
      }
    }

    function speak(text) {
      if(!voiceOn) return;
      window.speechSynthesis.cancel();
      const u = new SpeechSynthesisUtterance(text);
      u.lang = 'es-MX';
      window.speechSynthesis.speak(u);
    }

    function toggleVoice() {
      voiceOn = !voiceOn;
      document.getElementById('btn-voice').textContent = voiceOn ? "üó£Ô∏è Voz: ON" : "üîá Voz: OFF";
      document.getElementById('btn-voice').classList.toggle('active');
    }

    /* --- NAVEGACI√ìN --- */
    function show(id) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    /* --- TUTORIAL L√ìGICA PASO A PASO --- */
    let tutStep = 0;
    
    function startTutorial() {
      playSound('click');
      show('screen-tutorial');
      tutStep = 1;
      runTutorialStep();
    }

    function nextTutorialStep() {
      tutStep++;
      runTutorialStep();
    }

    function runTutorialStep() {
      const bubble = document.getElementById('tut-speech');
      const area = document.getElementById('tut-interaction');
      const nextBtn = document.getElementById('tut-next-btn');
      nextBtn.style.display = 'none'; // Ocultar hasta completar acci√≥n

      if (tutStep === 1) {
        // INTRO
        bubble.innerHTML = "¬°Hola Dise√±ador! Soy la Productora.<br>Tu trabajo es entrenar a <b>Gen.IA</b> (nuestro cerebro digital) d√°ndole ejemplos para que aprenda.";
        area.innerHTML = `<div style="font-size:80px;">üß†</div>`;
        speak("Hola Dise√±ador. Tu trabajo es entrenar a Genia d√°ndole ejemplos.");
        setTimeout(() => { nextBtn.style.display = 'block'; }, 2000); // Auto-avanza un poco despu√©s
      } 
      else if (tutStep === 2) {
        // EL PROBLEMA
        bubble.innerHTML = "Vamos a hacer una prueba. <br>Dale esta <b>Carpeta de Espadas</b> a Gen.IA y veamos qu√© pasa.";
        // Flecha apuntando
        area.innerHTML = `
          <div style="position:relative;">
            <div class="pointer-hand" style="top:-50px; left:40px;">üëá</div>
            <button class="tut-folder-btn" onclick="tutFailTrigger()">
              <span style="font-size:30px">üó°Ô∏è</span>
              <span>Datos</span>
            </button>
          </div>
          <div style="font-size:30px;">‚û°</div>
          <div style="font-size:60px;">üß†</div>
        `;
        speak("Dale la carpeta de espadas a Genia y veamos qu√© pasa.");
      }
      else if (tutStep === 3) {
        // EL RESULTADO (SESGO)
        bubble.innerHTML = "<b style='color:var(--danger)'>¬°ERROR! JUEGO SESGADO.</b><br>Como solo le diste espadas, Gen.IA cre√≥ un juego donde <i>todos</i> deben pelear. <br>Al Mago y al Explorador NO les gust√≥.";
        area.innerHTML = `
          <div style="text-align:center;">
             <div>JUEGO CREADO: "GUERRA TOTAL"</div>
             <div style="display:flex; gap:15px; font-size:40px; margin-top:10px; justify-content:center;">
                <span title="Guerrero Feliz">üòÉ</span>
                <span title="Mago Triste">üòü</span>
                <span title="Explorador Triste">üòü</span>
             </div>
          </div>
        `;
        playSound('bad');
        speak("¬°Error! Juego sesgado. Al mago y al explorador no les gust√≥ porque solo hay peleas.");
        setTimeout(() => { nextBtn.style.display = 'block'; nextBtn.innerText = "¬°Entendido!"; }, 1000);
      }
      else if (tutStep === 4) {
        // FIN TUTORIAL
        show('screen-game');
        playSound('click');
        initGame();
      }
    }

    function tutFailTrigger() {
      nextTutorialStep();
    }

    /* --- L√ìGICA DE JUEGO --- */
    let decisions = { 1: null, 2: null, 3: null };

    function initGame() {
      // Reset visual
      decisions = { 1: null, 2: null, 3: null };
      document.querySelectorAll('.design-card').forEach(c => {
        c.classList.remove('active', 'done');
        c.querySelector('.card-title').classList.remove('done-text');
      });
      document.getElementById('card-1').classList.add('active');
      document.getElementById('btn-launch').classList.remove('ready');
      document.getElementById('btn-launch').disabled = true;
      
      // Reset Stars
      ['war','mag','exp'].forEach(id => document.getElementById('s-'+id).innerText = '‚≠ê‚≠ê‚≠ê');
      
      addConsoleLine(">> Nueva sesi√≥n iniciada.");
      speak("Ahora es tu turno. Selecciona carpetas con VARIEDAD para ganar.");
    }

    function selectCard(id, option) {
      playSound('click');
      decisions[id] = option;
      
      const card = document.getElementById('card-'+id);
      
      // Feedback Visual en la Opci√≥n
      const btns = card.querySelectorAll('.option-btn');
      btns.forEach(b => b.className = 'option-btn'); // Limpiar
      
      // L√≥gica de "Variety" (B es buena, A es mala/sesgada)
      const isGood = (option === 'B');
      
      if (isGood) {
        playSound('good');
        showToast("‚ú® ¬°Excelente! Agregaste variedad.", "good");
        addConsoleLine(`>> Paso ${id}: Datos diversos cargados.`);
        speak("¬°Excelente elecci√≥n! Agregaste variedad.");
      } else {
        playSound('bad');
        showToast("‚ö†Ô∏è Cuidado: Poca variedad detectada.", "bad");
        addConsoleLine(`>> Paso ${id}: WARNING. Datos limitados.`);
        speak("Cuidado. Esa carpeta tiene poca variedad.");
      }

      // Marcar tarjeta como lista
      card.classList.remove('active');
      card.classList.add('done');
      card.querySelector('.card-title').innerText += " (Listo)";
      card.querySelector('.card-title').classList.add('done-text');

      // Activar siguiente
      if (id < 3) {
        document.getElementById('card-'+(id+1)).classList.add('active');
      } else {
        // Habilitar bot√≥n final
        const launch = document.getElementById('btn-launch');
        launch.disabled = false;
        launch.classList.add('ready');
        launch.innerText = "üöÄ LANZAR JUEGO (Click)";
        addConsoleLine(">> Compilaci√≥n lista.");
        speak("¬°Juego listo! Presiona Lanzar.");
      }

      updateTesters();
    }

    function updateTesters() {
      // C√°lculo simple de felicidad basado en elecciones acumuladas
      let score = 0;
      if (decisions[1] === 'B') score++;
      if (decisions[2] === 'B') score++;
      if (decisions[3] === 'B') score++;

      // Animaci√≥n
      document.querySelectorAll('.tester-item').forEach(el => {
        el.classList.remove('bounce');
        void el.offsetWidth; // trigger reflow
        el.classList.add('bounce');
      });

      // Actualizar estrellas visuales (L√≥gica simplificada para demo)
      // Guerrero siempre feliz (le gusta todo), otros dependen de score
      document.getElementById('s-war').innerText = '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê';
      
      // Mago y Explorador suben estrellas seg√∫n score (0 a 3 opciones buenas)
      // Score 0: 1 estrella. Score 3: 5 estrellas.
      let stars = '‚≠ê';
      if(score >= 1) stars = '‚≠ê‚≠ê';
      if(score >= 2) stars = '‚≠ê‚≠ê‚≠ê‚≠ê';
      if(score === 3) stars = '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê';

      document.getElementById('s-mag').innerText = stars;
      document.getElementById('s-exp').innerText = stars;
    }

    function addConsoleLine(text) {
      const con = document.getElementById('ai-console');
      con.innerHTML += `<div class="console-line">${text}</div>`;
      con.scrollTop = con.scrollHeight;
    }

    function showToast(msg, type) {
      const t = document.getElementById('toast');
      t.innerText = msg;
      t.className = `toast show ${type}`;
      setTimeout(() => t.className = 'toast', 2500);
    }

    function finishGame() {
      let bCount = 0;
      if (decisions[1] === 'B') bCount++;
      if (decisions[2] === 'B') bCount++;
      if (decisions[3] === 'B') bCount++;

      show('screen-result');
      const title = document.getElementById('res-title');
      const text = document.getElementById('res-text');
      const emoji = document.getElementById('res-emoji');
      const stars = document.getElementById('res-stars');

      if (bCount === 3) {
        playSound('win');
        emoji.innerText = "üèÜ";
        title.innerText = "¬°Obra Maestra Inclusiva!";
        text.innerText = "¬°Incre√≠ble! Creaste un juego con avatares diversos, m√∫sica variada y misiones para todos los gustos. ¬°Todos los testers te dan 5 estrellas!";
        stars.innerText = "‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ";
        speak("¬°Incre√≠ble! Todos los testers te dan 5 estrellas. Eres un experto en inclusi√≥n.");
      } else if (bCount === 2) {
        playSound('good');
        emoji.innerText = "üôÇ";
        title.innerText = "Buen Juego";
        text.innerText = "El juego es divertido, pero un grupo de jugadores se sinti√≥ un poco olvidado. ¬°Casi lo logras!";
        stars.innerText = "‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ";
        speak("Buen juego, pero casi lo logras. Intenta m√°s variedad la pr√≥xima vez.");
      } else {
        playSound('bad');
        emoji.innerText = "üòü";
        title.innerText = "Juego Roto por Sesgo";
        text.innerText = "Usaste carpetas con muy poca variedad. Muchos jugadores se aburrieron o no se sintieron representados.";
        stars.innerText = "‚òÖ‚òÖ‚òÜ‚òÜ‚òÜ";
        speak("Juego roto. Usaste carpetas con muy poca variedad. Int√©ntalo de nuevo.");
      }
    }

    function restartGame() {
      playSound('click');
      show('screen-start');
    }

  </script>
</body>
</html>
